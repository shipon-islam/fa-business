(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6337],{6394:(e,t,s)=>{Promise.resolve().then(s.bind(s,8389))},7234:(e,t,s)=>{"use strict";s.d(t,{A:()=>i});var a=s(5155);function i(e){let{className:t,name:s,...i}=e;return(0,a.jsx)("button",{className:"bg-gold hover:bg-deepGold transition-colors duration-300 text-[1.1rem] md:text-lg lg:text-xl px-6 py-2 rounded-md cursor-pointer  ".concat(t),...i,children:s})}},8389:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>u});var a=s(5155),i=s(7234),l=s(7129);let r=["image/jpg","image/jpeg","image/png","image/webp"],o=e=>l.Ik({title:l.Yj().min(5,"minimum 3 character").required("title is required"),content:l.Yj().min(10,"minimum 10 character").required("Content is required"),image:l.gl().test("required","Image is required",t=>!!e||t&&t.length>0).test("fileSize","File too large",t=>!!e||!t||!t[0]||t[0].size<=2097152).test("fileFormat","Unsupported Format",t=>!!e||!t||!t[0]||r.includes(t[0].type))}).required();var n=s(2461),c=s(6766),d=s(2115),m=s(2177),g=s(3568);function u(){let[e,t]=(0,d.useState)([]),[s,l]=(0,d.useState)(!1),[r,u]=(0,d.useState)(!1),[h,p]=(0,d.useState)(!1),[x,b]=(0,d.useState)({id:"",existingImage:""}),{reset:f,register:j,handleSubmit:w,formState:{errors:y}}=(0,m.mN)({resolver:(0,n.t)(o(r))});(0,d.useEffect)(()=>{!async function(){let e=await fetch("/api/blog");if(!e.ok)throw Error("something went wrong");t(await e.json())}()},[h]);let N=async s=>{if(confirm("Are you sure you want to delete this item?"))try{if(!(await fetch("/api/blog/".concat(s),{method:"DELETE"})).ok)throw Error("Network response was not ok");t(e.filter(e=>e._id!==s)),g.Ay.success("Blog deleted successfully!")}catch(e){console.error("There was a problem with the delete operation:",e),g.Ay.error(e.message)}},v=async e=>{let t=new FormData;if(t.append("title",e.title),t.append("content",e.content),e.image&&e.image.length>0&&t.append("image",e.image[0]),l(!0),r){t.append("existingImage",x.existingImage);try{let e=await fetch("/api/blog/".concat(x.id),{method:"PUT",body:t}),s=await e.json();s&&(console.log("edited blog",s),f({title:"",content:"",image:[]}),l(!1),u(!1),p(!h),g.Ay.success("Blog updated successfully!"))}catch(e){g.Ay.error(e.message),console.error("Error updating blog:",e)}}else try{let e=await fetch("/api/blog",{method:"POST",body:t});await e.json()&&(f(),l(!1),u(!1),p(!h),g.Ay.success("Blog created successfully!"))}catch(e){console.log(e),l(!1),g.Ay.error(e.message)}},k=e=>{u(!0),b({id:e._id,existingImage:e.image}),f({title:e.title,content:e.content,image:[]}),window.scrollTo(0,0,{behavior:"smooth"})};return(0,a.jsxs)("div",{className:"md:w-4/5 mx-auto",children:[(0,a.jsxs)("div",{className:"mt-10",children:[(0,a.jsx)("h1",{className:"text-3xl font-semibold",children:"Create New Post"}),(0,a.jsxs)("form",{onSubmit:w(v),className:"grid gap-y-8 mt-10",action:"#",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("input",{type:"text",className:"border border-gray-300 p-4 rounded-md w-full block",placeholder:"Post Title",...j("title")}),y.title&&(0,a.jsx)("p",{className:"text-red-500 ml-1 ",children:y.title.message})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("textarea",{placeholder:"Write a Post...",className:"border border-gray-300 w-full focus:outline-0 rounded-md p-3 min-h-36 ",...j("content")}),y.content&&(0,a.jsx)("p",{className:"text-red-500 ml-1 ",children:y.content.message})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("input",{type:"file",className:"border border-gray-300 p-4 rounded-md accent-amber-50 w-full block",...j("image")}),y.image&&(0,a.jsx)("p",{className:"text-red-500 ml-1 ",children:y.image.message})]}),r?(0,a.jsx)(i.A,{name:s?"Editing...":"Edit Post",className:"!bg-blue-600 text-white rounded-lg  w-fit"}):(0,a.jsx)(i.A,{name:s?"Publishing...":"Publish",className:"!bg-blue-600 text-white rounded-lg  w-fit"})]})]}),(0,a.jsxs)("div",{className:"mt-20",children:[(0,a.jsx)("h1",{className:"mb-5 font-bold text-xl",children:"Recent Posts (Last 5)"}),0===e.length&&(0,a.jsx)("p",{className:"text-gray-500 text-2xl mt-8",children:"There is no blog yet!"}),(0,a.jsx)("div",{className:"grid gap-8 lg:grid-cols-2 ",children:null==e?void 0:e.map(e=>(0,a.jsxs)("div",{className:"custom-shadow p-4 rounded-md ",children:[(0,a.jsx)("h5",{className:"font-semibold  py-1",children:e.title}),(0,a.jsx)(c.default,{src:"/api/uploads/blog/".concat(e.image),width:700,height:200,alt:"post",className:"rounded-md object-cover w-full h-40"}),(0,a.jsx)("h5",{className:"my-2",children:e.content}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{onClick:()=>N(e._id),className:"text-gold cursor-pointer",children:"Delete"}),(0,a.jsx)("button",{onClick:()=>k(e),className:"text-blue-600 cursor-pointer",children:"Edit"})]})]},e._id))})]}),(0,a.jsx)("div",{className:"h-screen"})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[6766,3568,6757,8441,9303,7358],()=>t(6394)),_N_E=e.O()}]);