(()=>{var e={};e.id=7758,e.ids=[7758],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},29911:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>y,routeModule:()=>g,serverHooks:()=>w,workAsyncStorage:()=>x,workUnitAsyncStorage:()=>v});var s={};r.r(s),r.d(s,{POST:()=>m});var n=r(96559),a=r(48088),i=r(37719),o=r(73095),u=r(48134),p=r(81367),c=r(48240),d=r(32190);let l=parseInt(process.env.JWT_TOKEN_EXPIRED||"86400");async function m(e){await (0,o.o)();let{email:t,password:r}=await e.json();if(!r)return d.NextResponse.json({error:"Missing required fields"},{status:400});try{let e=await u.F.findOne({email:t});if(!e||!await (0,p.b)(r,e.password))return d.NextResponse.json({error:"Invalid credentials"},{status:401});let s=await (0,c.z)({id:e.id,email:e.email,role:e.role,avatar:e?.avatar||"",name:e.name}),n=d.NextResponse.json({message:"Login successful"},{status:200});return n.cookies.set("token",s,{httpOnly:!0,path:"/",maxAge:l,sameSite:"strict"}),n}catch(e){return console.log(e),d.NextResponse.json({error:"something went wrong"},{status:500})}}let g=new n.AppRouteRouteModule({definition:{kind:a.RouteKind.APP_ROUTE,page:"/api/auth/login/route",pathname:"/api/auth/login",filename:"route",bundlePath:"app/api/auth/login/route"},resolvedPagePath:"C:\\Users\\Shipon Islam\\Desktop\\Next-Project\\fabusiness\\src\\app\\api\\auth\\login\\route.js",nextConfigOutput:"",userland:s}),{workAsyncStorage:x,workUnitAsyncStorage:v,serverHooks:w}=g;function y(){return(0,i.patchFetch)({workAsyncStorage:x,workUnitAsyncStorage:v})}},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},48134:(e,t,r)=>{"use strict";r.d(t,{F:()=>i});var s=r(56037),n=r.n(s);let a=new(n()).Schema({name:{type:String,required:!0,minlength:3},email:{type:String,required:!0},avatar:{type:String},role:{type:String,enum:["admin","user"],default:"user"},password:{type:String,required:!0}},{timestamps:!0}),i=s.models.User||n().model("User",a)},48240:(e,t,r)=>{"use strict";r.d(t,{n:()=>p,z:()=>u});var s=r(87806),n=r(77412);let a=process.env.JWT_SECRET,i=parseInt(process.env.JWT_TOKEN_EXPIRED||"86400"),o=new TextEncoder().encode(a);async function u(e){return await new s.P(e).setProtectedHeader({alg:"HS256"}).setIssuedAt().setExpirationTime(`${i}s`).sign(o)}async function p(e){try{let{payload:t}=await (0,n.V)(e,o);if("admin"===t.role)return t;return null}catch(e){return console.error("Token verification failed:",e.message),null}}},55511:e=>{"use strict";e.exports=require("crypto")},56037:e=>{"use strict";e.exports=require("mongoose")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},73095:(e,t,r)=>{"use strict";r.d(t,{o:()=>a});var s=r(56037),n=r.n(s);async function a(){n().connections[0].readyState||await n().connect(process.env.DATABASE_URL||"")}},78335:()=>{},81367:(e,t,r)=>{"use strict";r.d(t,{E:()=>n,b:()=>a});var s=r(85663);let n=async e=>await s.Ay.hash(e,10),a=async(e,t)=>await s.Ay.compare(e,t)},96487:()=>{}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[4447,580,4553,5663],()=>r(29911));module.exports=s})();