(()=>{var e={};e.id=8832,e.ids=[8832],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},3590:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>j,routeModule:()=>h,serverHooks:()=>b,workAsyncStorage:()=>w,workUnitAsyncStorage:()=>x});var s={};r.r(s),r.d(s,{DELETE:()=>f,GET:()=>m,PUT:()=>y});var n=r(96559),o=r(48088),a=r(37719),i=r(73095),u=r(83055),l=r(48134),p=r(58288),d=r(11308),c=r(62351),g=r(32190);async function m(e,t){let{id:r}=await t.params;console.log(l.F);try{await (0,i.o)();let e=await u._.findById(r).populate("author");if(!e)return new g.NextResponse("blogs not found",{status:404});return g.NextResponse.json(e,{status:200,headers:{"Content-Type":"application/json"}})}catch(e){return console.log(e),g.NextResponse.json("something went wrong",{status:500})}}async function f(e,t){let{id:r}=await t.params;console.log(l.F);try{await (0,i.o)();let e=await u._.findByIdAndDelete(r);if(!e)return new g.NextResponse({error:"blog deletion failed"},{status:500});return(0,p.W)("blog",e.image),["/","/blogs"].forEach(e=>(0,c.revalidatePath)(e)),g.NextResponse.json({message:"blog deleted successfully"},{status:200,headers:{"Content-Type":"application/json"}})}catch(e){return console.log(e),g.NextResponse.json({error:"something went wrong"},{status:500})}}async function y(e,t){let r,{id:s}=await t.params,n=await e.formData(),{image:o,title:a,content:l,existingImage:m}=Object.fromEntries(n);if(!n.has("title")||!n.has("content")||!n.has("image")&&!m)return g.NextResponse.json({error:"Missing required fields"},{status:400});try{if(o){let e=await (0,d.V)(o,"blog");r={title:a,content:l,image:e}}else r={title:a,content:l,image:m};if(await (0,i.o)(),!await u._.findByIdAndUpdate(s,r))return new g.NextResponse({error:"blog deletion failed"},{status:500});return o&&(0,p.W)("blog",m),["/","/blogs"].forEach(e=>(0,c.revalidatePath)(e)),g.NextResponse.json({message:"blog updated successfully"},{status:200,headers:{"Content-Type":"application/json"}})}catch(e){return console.log(e),g.NextResponse.json({error:"something went wrong"},{status:500})}}let h=new n.AppRouteRouteModule({definition:{kind:o.RouteKind.APP_ROUTE,page:"/api/blog/[id]/route",pathname:"/api/blog/[id]",filename:"route",bundlePath:"app/api/blog/[id]/route"},resolvedPagePath:"C:\\Users\\Shipon Islam\\Desktop\\Next-Project\\fabusiness\\src\\app\\api\\blog\\[id]\\route.js",nextConfigOutput:"",userland:s}),{workAsyncStorage:w,workUnitAsyncStorage:x,serverHooks:b}=h;function j(){return(0,a.patchFetch)({workAsyncStorage:w,workUnitAsyncStorage:x})}},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11308:(e,t,r)=>{"use strict";r.d(t,{V:()=>g});var s=r(29021),n=r.n(s),o=r(33873),a=r.n(o),i=r(55511);let u={randomUUID:i.randomUUID},l=new Uint8Array(256),p=l.length,d=[];for(let e=0;e<256;++e)d.push((e+256).toString(16).slice(1));let c=function(e,t,r){if(u.randomUUID&&!t&&!e)return u.randomUUID();let s=(e=e||{}).random??e.rng?.()??(p>l.length-16&&((0,i.randomFillSync)(l),p=0),l.slice(p,p+=16));if(s.length<16)throw Error("Random bytes length must be >= 16");if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t){if((r=r||0)<0||r+16>t.length)throw RangeError(`UUID byte range ${r}:${r+15} is out of buffer bounds`);for(let e=0;e<16;++e)t[r+e]=s[e];return t}return function(e,t=0){return(d[e[t+0]]+d[e[t+1]]+d[e[t+2]]+d[e[t+3]]+"-"+d[e[t+4]]+d[e[t+5]]+"-"+d[e[t+6]]+d[e[t+7]]+"-"+d[e[t+8]]+d[e[t+9]]+"-"+d[e[t+10]]+d[e[t+11]]+d[e[t+12]]+d[e[t+13]]+d[e[t+14]]+d[e[t+15]]).toLowerCase()}(s)},g=async(e,t)=>{let r=await e.arrayBuffer(),s=Buffer.from(r),o=a().join(process.cwd(),"uploads",t);n().existsSync(o)||n().mkdirSync(o,{recursive:!0});let i=c()+"-"+e.name,u=a().join(o,i);return n().writeFileSync(u,s),i}},29021:e=>{"use strict";e.exports=require("fs")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},48134:(e,t,r)=>{"use strict";r.d(t,{F:()=>a});var s=r(56037),n=r.n(s);let o=new(n()).Schema({name:{type:String,required:!0,minlength:3},email:{type:String,required:!0},avatar:{type:String},role:{type:String,enum:["admin","user"],default:"user"},password:{type:String,required:!0}},{timestamps:!0}),a=s.models.User||n().model("User",o)},55511:e=>{"use strict";e.exports=require("crypto")},56037:e=>{"use strict";e.exports=require("mongoose")},58288:(e,t,r)=>{"use strict";r.d(t,{W:()=>i});var s=r(29021),n=r.n(s),o=r(33873),a=r.n(o);let i=(e,t)=>{let r=a().join(process.cwd(),"uploads",e,t);return!!n().existsSync(r)&&(n().unlinkSync(r),!0)}},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},73095:(e,t,r)=>{"use strict";r.d(t,{o:()=>o});var s=r(56037),n=r.n(s);async function o(){n().connections[0].readyState||await n().connect(process.env.DATABASE_URL||"")}},78335:()=>{},83055:(e,t,r)=>{"use strict";r.d(t,{_:()=>a});var s=r(56037),n=r.n(s);let o=new(n()).Schema({title:{type:String,required:!0,trim:!0,minlength:3},author:{type:n().Schema.Types.ObjectId,ref:"User",required:!0},content:{type:String,required:!0,trim:!0,minlength:10},image:{type:String,required:!0}},{timestamps:!0}),a=s.models.Blog||n().model("Blog",o)},96487:()=>{}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[4447,580,2351],()=>r(3590));module.exports=s})();